# 山水卡片学习系统部署常见问题

## 基础问题

### Q1: 什么是 Vercel？为什么选择它来部署山水卡片学习系统？

**A:** Vercel 是一个面向前端和静态站点的云平台，专为现代 Web 应用设计。我们选择 Vercel 是因为它提供：

- 免费托管
- 自动 HTTPS
- 全球 CDN 加速
- 与 GitHub 的无缝集成
- 极简的部署流程
- Serverless 函数支持
  这些特性使其成为部署山水卡片学习系统的理想选择。

### Q2: 部署到 Vercel 需要多少费用？

**A:** Vercel 提供慷慨的免费计划，对于个人项目和小型团队完全足够。免费计划包括：

- 无限的个人项目
- 每月 100GB 的带宽
- 无限的 API 请求
- 基本的分析和日志
- 免费的自定义域名支持
  如果需要更多资源或高级功能，可以考虑升级到付费计划。

### Q3: 我需要自己的域名吗？

**A:** 不需要。Vercel 会为每个项目提供一个`[your-project].vercel.app`的子域名。当然，如果您想使用自己的域名，Vercel 也完全支持，且不额外收费。

### Q4: 在中国大陆访问 Vercel 部署的站点速度如何？

**A:** Vercel 有全球 CDN 节点，但在中国大陆没有直接节点。对于一般访问，速度是可以接受的，但如果您的主要用户在中国大陆，可以考虑以下优化方案：

- 使用国内 CDN 加速（如阿里云 CDN）
- 使用国内云服务提供商部署额外的实例
- 选择香港或东亚地区的服务器进行部署

## 部署相关问题

### Q5: 我的项目部署失败，如何排查问题？

**A:** 部署失败时，请检查以下几点：

1. 查看 Vercel 提供的构建日志，找出具体错误
2. 确认`package.json`中的依赖和脚本正确无误
3. 确认`vercel.json`配置正确
4. 验证项目在本地环境能正确运行
5. 检查是否超过了 Vercel 的限制（如构建时间、包大小等）

如果问题持续存在，可以尝试清除缓存并重新部署，或者联系 Vercel 支持。

### Q6: 如何更新已部署的应用？

**A:** 只需将更改推送到与 Vercel 关联的 GitHub 仓库，Vercel 会自动检测变更并触发新的部署。部署完成后，您的更改会自动上线，无需任何手动干预。

### Q7: 如何回滚到之前的版本？

**A:** Vercel 会保留您的部署历史。要回滚到先前版本：

1. 登录 Vercel 控制台
2. 进入您的项目
3. 点击"Deployments"标签
4. 找到您想回滚到的版本
5. 点击该版本右侧的三点菜单（⋮）
6. 选择"Promote to Production"

### Q8: 如何添加环境变量？

**A:** 在 Vercel 添加环境变量的步骤：

1. 登录 Vercel 控制台
2. 进入项目设置
3. 点击"Environment Variables"
4. 添加键值对
5. 选择变量适用的环境（生产、预览或开发）
6. 点击"Save"保存

## 性能与优化问题

### Q9: 如何优化应用在 Vercel 上的性能？

**A:** 优化性能的几个关键点：

1. **资源优化**：压缩图片，使用 WebP 格式；压缩 JS 和 CSS 文件
2. **懒加载**：对于图片和非关键组件使用懒加载
3. **缓存策略**：在`vercel.json`中为静态资源设置适当的缓存头
4. **减少依赖**：审查并精简项目依赖
5. **代码分割**：实现代码分割以减少初始加载时间
6. **预渲染**：考虑使用静态生成而非服务器端渲染

### Q10: 如何监控应用的性能和使用情况？

**A:** Vercel 提供基本的分析功能，您还可以集成：

- Google Analytics：跟踪访问和用户行为
- Sentry：监控错误和性能问题
- New Relic：深入的性能监控
- Datadog：全栈可观测性平台

## 安全问题

### Q11: Vercel 如何处理 HTTPS 和安全问题？

**A:** Vercel 自动为所有部署提供 SSL 证书，确保所有流量通过 HTTPS 加密传输。此外，Vercel 还提供：

- DDoS 防护
- 自动证书更新
- 内容安全策略支持
- 各种 HTTP 安全头部选项

### Q12: 如何保护 API 端点和敏感数据？

**A:** 保护 API 和敏感数据的最佳实践：

1. 使用环境变量存储敏感信息，而非硬编码
2. 实现适当的身份验证和授权机制
3. 限制 API 速率以防止滥用
4. 为 API 请求实现 CORS 策略
5. 考虑使用 JWT 或其他 token 机制进行 API 认证

## 高级问题

### Q13: 如何设置自定义域名并配置 DNS？

**A:** 设置自定义域名的步骤：

1. 在 Vercel 项目设置中找到"Domains"部分
2. 添加您的域名
3. 按照 Vercel 的指示配置 DNS 记录：
   - 通常是添加一条 A 记录指向 Vercel 的 IP
   - 或添加一条 CNAME 记录指向 Vercel 提供的值
4. 等待 DNS 传播（通常需要几分钟到几小时）
5. Vercel 会自动为您的域名提供 SSL 证书

### Q14: 如何实现持续集成/持续部署(CI/CD)？

**A:** Vercel 已经与 GitHub 集成，提供自动部署功能。对于更高级的 CI/CD 需求：

1. 在 GitHub 仓库中设置工作流程（如 GitHub Actions）
2. 配置测试和构建步骤
3. 使用 Vercel CLI 进行部署集成
4. 考虑添加预部署检查，如代码质量分析、安全扫描等

### Q15: 如何处理大型文件或媒体内容？

**A:** Vercel 不适合存储大型媒体文件，建议：

1. 使用专门的对象存储服务，如 AWS S3、阿里云 OSS
2. 使用 CDN 服务分发媒体内容
3. 优化媒体文件（压缩、转换格式等）
4. 对于用户上传的内容，直接将文件上传到对象存储服务，而非通过 Vercel

## 故障排除

### Q16: 我的静态资源无法加载，如何解决？

**A:** 检查以下几点：

1. 确认资源路径正确（相对路径还是绝对路径）
2. 检查`vercel.json`中的路由配置是否正确
3. 确认资源文件确实包含在构建输出中
4. 检查浏览器控制台是否有相关错误

### Q17: 我的 API 路由返回 404，如何解决？

**A:** API 路由问题排查：

1. 确认 API 路由在`api`目录中正确定义
2. 检查`vercel.json`中的路由配置
3. 确认函数导出正确（应该导出一个处理请求的函数）
4. 尝试在本地使用 Vercel CLI 测试 API 路由

### Q18: Vercel 部署成功但网站内容不是最新的，如何解决？

**A:** 这可能是缓存问题，尝试：

1. 强制刷新浏览器（Ctrl+F5 或 Cmd+Shift+R）
2. 清除浏览器缓存
3. 检查 Vercel 部署日志，确认最新代码确实被部署
4. 在 Vercel 控制台中，检查是否有多个生产部署，确保最新部署被设为生产版本

## 技术支持

### Q19: 如果遇到无法解决的问题，哪里可以获得支持？

**A:** 您可以通过以下渠道获取支持：

1. Vercel 的官方文档：[https://vercel.com/docs](https://vercel.com/docs)
2. Vercel 的社区论坛：[https://github.com/vercel/vercel/discussions](https://github.com/vercel/vercel/discussions)
3. 山水卡片学习系统 GitHub 仓库的 Issues 页面
4. 技术社区如 Stack Overflow（使用相关标签如"vercel"）

### Q20: 如何从 Vercel 迁移到其他平台？

**A:** 迁移步骤：

1. 导出 Vercel 环境变量
2. 确保代码库不依赖 Vercel 特有的功能
3. 如果使用 Serverless 函数，可能需要调整为目标平台支持的格式
4. 设置新平台的部署流程
5. 更新 DNS 记录，将域名指向新平台
6. 监控迁移过程，确保所有功能正常工作
