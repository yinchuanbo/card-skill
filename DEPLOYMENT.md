# 山水卡片学习系统部署指南

本文档提供了如何将山水卡片学习系统部署到 Vercel 上的详细指南。Vercel 提供免费托管、自动 HTTPS 和全球 CDN 加速，是部署此类应用的理想选择。

## 为什么选择 Vercel？

- **免费使用**: 对个人项目和小型团队提供慷慨的免费层级
- **自动部署**: 与 GitHub 集成，每次推送代码后自动部署
- **全球 CDN**: 通过全球边缘网络提供内容，确保全球各地的低延迟访问
- **简单配置**: 无需复杂的服务器设置，自动检测和配置 Node.js 应用
- **HTTPS 支持**: 自动为所有部署提供 HTTPS 证书
- **预览部署**: 为每个 Pull Request 创建独立的预览环境

## 部署步骤

### 1. 准备工作

确保您的项目仓库包含以下文件：

- `vercel.json`: Vercel 配置文件，定义构建和路由规则
- `server.js`: Express 应用程序，已适配 Vercel 环境
- `package.json`: 包含必要的依赖和脚本

### 2. 创建 Vercel 账号

1. 访问 [Vercel 官网](https://vercel.com)
2. 点击"Sign Up"注册账号
3. 可以使用 GitHub、GitLab 或 Bitbucket 账户直接登录

### 3. 安装 Vercel CLI (可选)

如果您希望通过命令行部署，可以安装 Vercel CLI：

```bash
npm i -g vercel
```

### 4. 通过 GitHub 部署

1. 在 GitHub 上 Fork 或 Clone 山水卡片学习系统仓库
2. 登录 Vercel 控制台
3. 点击"New Project"
4. 从列表中选择您的 GitHub 仓库
5. Vercel 会自动检测项目类型为 Node.js
6. 如有需要，您可以设置环境变量
7. 点击"Deploy"开始部署
8. 部署完成后，Vercel 会提供一个`[your-project].vercel.app`的域名

### 5. 通过 Vercel CLI 部署（可选）

1. 在项目目录中登录 Vercel：

   ```bash
   vercel login
   ```

2. 部署项目：

   ```bash
   vercel
   ```

3. 按照提示操作，选择项目设置和环境

### 6. 配置自定义域名（可选）

1. 在 Vercel 项目仪表板中，导航到"Settings" > "Domains"
2. 点击"Add"添加您的自定义域名
3. 按照 Vercel 的指示配置 DNS 记录
   - 通常需要添加 A 记录或 CNAME 记录指向 Vercel 的服务器
4. 等待 DNS 传播（通常需要几分钟到几小时）

### 7. 验证部署

1. 访问 Vercel 提供的 URL 或您配置的自定义域名
2. 确认网站正常加载，并测试所有功能正常工作
3. 检查控制台是否有错误

## 注意事项

### 环境变量

如果您的应用需要环境变量，可以在 Vercel 控制台中添加：

1. 在项目设置中找到"Environment Variables"选项
2. 添加必要的环境变量（键值对）
3. 设置环境变量的作用范围（生产环境、预览环境等）

### 服务器端限制

Vercel 的 serverless 函数有以下限制：

- 执行时间: 最多 10 秒（免费计划）
- 请求大小: 最大 5MB
- 响应大小: 最大 10MB

确保您的应用遵循这些限制。

### 定期访问

Vercel 的免费项目如果长期不被访问可能会进入"休眠"状态。为保持网站活跃，可以使用外部服务（如 UptimeRobot）定期访问您的网站。

## 故障排除

### 部署失败

1. 检查构建日志找出错误
2. 确认`package.json`中包含了所有必要的依赖
3. 确认`vercel.json`配置正确

### 路由问题

如果某些 URL 返回 404：

1. 检查`vercel.json`中的路由配置
2. 确认服务器端路由处理是否正确

### 静态资源无法加载

1. 检查资源路径是否正确
2. 确认`vercel.json`中有为静态资源设置适当的路由

## 更新部署

只需将更改推送到 GitHub 仓库，Vercel 将自动部署更新。

## 本地开发与生产环境的区别

本地开发时，应用在一个完整的 Node.js 环境中运行。在 Vercel 上，应用运行在 serverless 环境中：

- 确保代码适应无状态环境
- 不要依赖本地文件系统的持久性
- 适应冷启动延迟

## 结论

通过 Vercel 部署山水卡片学习系统是一个简单且高效的选择，提供出色的性能和可靠性，同时免去了传统服务器管理的复杂性。
